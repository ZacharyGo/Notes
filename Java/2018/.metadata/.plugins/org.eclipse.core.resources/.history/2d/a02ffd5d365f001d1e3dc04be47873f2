package com.mytools;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;

public class SplitTextFile {

	public boolean splitFile(String sourceFile, String destinationFile, int numberOfRows, int fileSize, boolean headerPerPage) {
		String header;
		String destinationFileExt = destinationFile.substring(destinationFile.indexOf("."), destinationFile.length());
		destinationFile = destinationFile.substring(0, destinationFile.indexOf("."));

		BufferedReader bufferedReader;
		BufferedWriter writer;
		try {
			int outputCounter = 1;
			writer = new BufferedWriter(new FileWriter(destinationFile + "-" + outputCounter + ".csv"));
			String line;
			bufferedReader = new BufferedReader(new FileReader(sourceFile));

			try {
				int outputSize = 0;
				int numRows = 0;
				System.out.println("Copying to : " + destinationFile + outputCounter);
				while ((line = bufferedReader.readLine()) != null) {
					// line = line + "\n"; ????
					if (headerPerPage && header == "") {
						header = line;
					}
					if (numRows > numberOfRows || outputSize > fileSize) {
						writer.close();
						outputCounter++;
						writer = new BufferedWriter(new FileWriter(destinationFile + "-" + outputCounter + ".csv"));
						System.out.println("Copying to : " + CSVDestination + outputCounter);

						writer.append(header);
						numRows = 1;
						outputSize = header.length();
					}

					/*
					 * ColTools colTools = new ColTools();
					 * System.out.println(colTools.FixCol("DATE", false, "2019/01/31 0:00:00"));
					 * System.out.println(colTools.FixCol("DATE", false, "2019/01/31"));
					 * System.out.println(colTools.FixCol("DATE", false, "01/31/2019 0:00:00"));
					 * System.out.println(colTools.FixCol("DATE", false, "01/31/2019"));
					 */
					writer.append(splitCSVLine(line));
					outputSize = outputSize + line.length();
					numRows++;

				}
				writer.close();
				System.out.println("Total records : " + numRows);
			} catch (IOException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
		} catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			System.out.println("File not found: (Path)" + path);
			System.out.println("                (File)" + CSVSource);
			e.printStackTrace();
		} catch (IOException e) {
			e.printStackTrace();
		}
		return true;
	}
}
